# check_changed_sql_files.sh

This script checks whether `sql_files.txt` exists and contains any SQL files.  
It then sets an output variable `sql-files-changed` accordingly, which can be used by subsequent steps in a GitHub Actions workflow.

## Usage

```bash
./check_changed_sql_files.sh
```

This script does not take any arguments.

## What It Does

1. **Existence and Size Check**:  
   It checks whether the file `sql_files.txt` exists and is not empty. This file should be generated by a previous step that identifies changed SQL files.

2. **No Changed SQL Files**:  
   - If `sql_files.txt` does not exist or is empty, the script prints:
     ```
     No SQL files found to validate.
     ```
   - It then sets `sql-files-changed=false` in the GitHub Actions output and exits with a `0` status code.
   
   This scenario indicates that there's nothing to validate, so any further validation steps can be skipped if they depend on this condition.

3. **Changed SQL Files Present**:
   - If `sql_files.txt` exists and is not empty, the script sets `sql-files-changed=true` in the GitHub Actions output and exits with a `0` status code.
   
   This tells subsequent workflow steps that there are SQL files to process or validate.

## Exit Codes

- **0**: Successful execution.  
  - If no files were found, `sql-files-changed=false` is set.
  - If files were found, `sql-files-changed=true` is set.

## Dependencies

- **Environment Variables**:  
  - `GITHUB_OUTPUT`: Used to store the `sql-files-changed` output variable for a GitHub Actions workflow.

## Example in GitHub Actions

A typical scenario in a GitHub Actions workflow might look like this:

1. **Identify Changed Files Step**:  
   Generate `sql_files.txt` containing a list of changed SQL files.

2. **This Step**:  
   ```yaml
   - name: Check Changed SQL Files
     run: ./check_changed_sql_files.sh
   ```

   - If no files are found, the script sets `sql-files-changed=false` and prints a message. Subsequent steps that rely on SQL file changes can then skip their actions.
   - If files are found, the script sets `sql-files-changed=true`, allowing subsequent steps to run validations on those files.

3. **Subsequent Steps**:  
   Use the `sql-files-changed` variable to conditionally run validations:
   ```yaml
   - name: Validate SQL Files
     if: ${{ steps.check_changed_sql_files.outputs.sql-files-changed == 'true' }}
     run: ./validate_sql_files.sh
   ```